Training of 3 independent models on file PF00079.10000.fasta
Configuration:
transition_init : {'begin_to_match': <learnMSA.msa_hmm.Configuration.EntryInitializer object at 0x7ff6183e4f40>, 'match_to_end': <learnMSA.msa_hmm.Configuration.ExitInitializer object at 0x7ff6183e4580>, 'match_to_match': <learnMSA.msa_hmm.Configuration.MatchTransitionInitializer object at 0x7ff6183e4400>, 'match_to_insert': <learnMSA.msa_hmm.Configuration.MatchTransitionInitializer object at 0x7ff6183e40a0>, 'insert_to_match': <tensorflow.python.ops.init_ops_v2.Constant object at 0x7ff6183e4370>, 'insert_to_insert': <tensorflow.python.ops.init_ops_v2.Constant object at 0x7ff6183e4550>, 'match_to_delete': <learnMSA.msa_hmm.Configuration.MatchTransitionInitializer object at 0x7ff6183e4640>, 'delete_to_match': <tensorflow.python.ops.init_ops_v2.Constant object at 0x7ff6183e43d0>, 'delete_to_delete': <tensorflow.python.ops.init_ops_v2.Constant object at 0x7ff6183e4220>, 'left_flank_loop': <tensorflow.python.ops.init_ops_v2.Constant object at 0x7ff6183e47c0>, 'left_flank_exit': <tensorflow.python.ops.init_ops_v2.Constant object at 0x7ff6183e44f0>, 'right_flank_loop': <tensorflow.python.ops.init_ops_v2.Constant object at 0x7ff6183e4df0>, 'right_flank_exit': <tensorflow.python.ops.init_ops_v2.Constant object at 0x7ff6183f6070>, 'unannotated_segment_loop': <tensorflow.python.ops.init_ops_v2.Constant object at 0x7ff6183f60d0>, 'unannotated_segment_exit': <tensorflow.python.ops.init_ops_v2.Constant object at 0x7ff6183f6130>, 'end_to_unannotated_segment': <tensorflow.python.ops.init_ops_v2.Constant object at 0x7ff6183f6190>, 'end_to_right_flank': <tensorflow.python.ops.init_ops_v2.Constant object at 0x7ff6183f61f0>, 'end_to_terminal': <tensorflow.python.ops.init_ops_v2.Constant object at 0x7ff6183f6250>} , flank_init : <tensorflow.python.keras.initializers.initializers_v2.Zeros object at 0x7ff6183f62b0> , emission_init : [<learnMSA.msa_hmm.Configuration.EmissionInitializer object at 0x7ff7caf51b80>, <tensorflow.python.keras.initializers.initializers_v2.RandomNormal object at 0x7ff834c445e0>]
 , insertion_init : [<tensorflow.python.ops.init_ops_v2.Constant object at 0x7ff834c442e0>, <tensorflow.python.keras.initializers.initializers_v2.RandomNormal object at 0x7ff7caeeaca0>] , alpha_flank : 7000 , alpha_single : 1000000000.0
 , alpha_frag : 10000.0 , max_surgery_runs : 4 , length_init_quantile : 0.5
 , surgery_quantile : 0.5 , min_surgery_seqs : 10000.0 , len_mul : 0.8
 , batch_size : <function get_adaptive_batch_size at 0x7ff618498ee0> , learning_rate : 0.1 , epochs : [10, 2, 10]
 , use_prior : True , dirichlet_mix_comp_count : 1 , use_anc_probs : True
 , trainable_exchangeabilities : False , encoder_initializer : [<tensorflow.python.ops.init_ops_v2.Constant object at 0x7ff6183f63a0>, <tensorflow.python.ops.init_ops_v2.Constant object at 0x7ff6183f6430>, <tensorflow.python.keras.initializers.initializers_v2.RandomNormal object at 0x7ff86f82bdc0>] , background_distribution : [0.079066 0.055941 0.041977 0.053052 0.012937 0.040767 0.071586 0.057337
 0.022355 0.062157 0.099081 0.0646   0.022951 0.042302 0.04404  0.061197
 0.053287 0.012066 0.034155 0.069147]
 , frozen_insertions : [True, False] , surgery_del : 0.5 , surgery_ins : 0.5
 , emission_func : <function reduce_multinomial_emissions at 0x7ff88d64a280> , emission_matrix_generator : [<function make_default_emission_matrix at 0x7ff72d60f430>, <function make_default_emission_matrix at 0x7ff72d60f430>] , emission_prior : [<learnMSA.msa_hmm.MsaHmmCell.AminoAcidPrior object at 0x7ff87477eb20>, <__main__.SimpleDirichletPrior object at 0x7ff83d25efd0>]
 , kernel_dim : [25, 3] , num_rate_matrices : 3 , per_matrix_rate : True
 , matrix_rate_l2 : 0.1 , shared_rate_matrix : True
Fitting a model of length 289 on 10000 sequences.
Batch size= 256 Learning rate= 0.1
Using 1 GPUs.
Epoch 1/10
39/39 - 39s - loss: 771.0801 - loglik: -7.6922e+02 - logprior: -1.5794e+00
Epoch 2/10
39/39 - 35s - loss: 641.0095 - loglik: -6.3779e+02 - logprior: -2.1117e+00
Epoch 3/10
39/39 - 36s - loss: 629.8723 - loglik: -6.2646e+02 - logprior: -2.0884e+00
